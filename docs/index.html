<head>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" type="text/css" href="css/materialize.min.css"  media="screen,projection"/>
</head>
<body>
  <script src="https://code.jquery.com/jquery-2.2.3.js" integrity="sha256-laXWtGydpwqJ8JA+X9x2miwmaiKhn8tVmOVEigRNtP4=" crossorigin="anonymous"></script>
  <script src="js/d3.v4.min.js"></script>
  <script>
    d3v4 = d3
    window.d3 = null
  </script>
  <script src="js/d3.v3.5.17.min.js"></script>
  <script src="js/topojson.3.0.2.min.js"></script>
  <script src="js/datamaps.world.hires.custom.js"></script>
  <script src="https://code.jquery.com/jquery-2.2.3.js" integrity="sha256-laXWtGydpwqJ8JA+X9x2miwmaiKhn8tVmOVEigRNtP4=" crossorigin="anonymous"></script>
  <script src="js/defiant.min.js"></script>
  <script>
    d3v3 = d3
    window.d3 = null
  </script>
  <script src="js/materialize.min.js" type="text/javascript"></script>
  <script> 
    $(function(){
      $("#mapContent").load("map.html");
      $("#lowerContent").load("bars.html");
    });
  </script> 

  <ul id="slide-out" class="sidenav sidenav-fixed collection with-header" style="width: 310px;">
    <li class="collection-header"><h4>Airports</h4></li>
  </ul>
  <script>

    var current_airport = "LEBL"
    var current_year = "2018"

    var ul = d3v4.select("#slide-out")
    d3v4.json('data/local_airports.json', function(json) {
      ul.selectAll('a')
        .data(json)
        .enter()
        .append('a')
        .attr('class','collection-item blue-grey-text text-darken-2')
        .attr('href','#!')
        //.html(function(d){return "<b>"+d.name+"</b><br>"+d.iata+' - '+d.airpt;})
        .html(function(d){return "<b>"+d.name+"</b><br>"+d.iata;})
        .each(function(d){
          var $this = d3v4.select(this);
          if(d.airpt==current_airport)
            $this.attr('class', 'collection-item active yellow darken-4');
        })
        .on("click", function(d){
          var $this = d3v4.select(this);
          ul.selectAll('a').attr('class','collection-item blue-grey-text text-darken-2');
          $this.attr('class','collection-item active yellow darken-4');
          current_airport = d.name;
          updateMapInfo(this_datamap, true, d.airpt, "2018");
          updateBarsInfo(d.airpt);
        });
    });
    <!--ul.select('a')-->
    <!--  .enter()-->
    <!--  .attr('class','collection-item active')-->
    <!--  .html(function(d){ console.log("Huh"); return "HHH";});-->
  </script>
  <div class="main">
    <div class="wrapper" id="mapContent">
      <div class="push"></div>
    </div>
    <div class="lower" id="lowerContent"></div>
  </div>
</body>
